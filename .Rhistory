xlim=c(-2,2),
axisLabSize = 12,
title=NULL,
subtitle=NULL,
caption=NULL,
#transcriptPointSize = 0.5,
legendPosition = 0,
pointSize =
ifelse(rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table) %in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_DNA_METHYLATION ,
keytype = "ENTREZID", column="SYMBOL")),2.5,
ifelse(rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table)%in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),2.5,
ifelse(rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table)%in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c5$GO_lymphocyte_differentiation,
keytype = "ENTREZID", column="SYMBOL")),2.5,0.4))),
#ifelse(rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table)%in%
#         innateDB.viral.gene.names,2.5,0.4))),
labSize = 0,
colAlpha = 1,
gridlines.major = F,
gridlines.minor = F,
cutoffLineWidth = 0.5,
borderWidth = 0.5,
colCustom = key.vals.rlr)
dev.off()
# edgeR: analyzing WT and RLR (triple mutant) B cells together
# Author: Seung June Kim
library(edgeR)
library(gplots)
library(RColorBrewer)
library(gplots)
library(devtools)
library(org.Mm.eg.db)
library(GO.db)
library(AnnotationDbi)
library(DBI)
library(VennDiagram)
tiff("wt_gskvdmso_volcano.tiff",units="in",width=6,height=6,res=600)
EnhancedVolcano(b.wt.gskvdmso.volcano,
lab=rownames(topTags(tr.wt.gskvdmso, n="Inf")$table),
x="Log2FC",
y="pvalue",
selectLab =  selectlabs,
pCutoff = 0.05,
FCcutoff= 0,
ylim=c(1,5),
xlim=c(-2,2),
axisLabSize = 12,
title=NULL,
subtitle=NULL,
caption=NULL,
#transcriptPointSize = 0.5,
legendPosition = 0,
pointSize =
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table) %in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_DNA_METHYLATION ,
keytype = "ENTREZID", column="SYMBOL")),2.5,
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)%in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),2.5,
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)%in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c5$GO_lymphocyte_differentiation,
keytype = "ENTREZID", column="SYMBOL")),2.5,0.4))),
#ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)%in%
#innateDB.viral.gene.names,2.5,0.4))),
labSize = 0,
colAlpha = 1,
gridlines.major = F,
gridlines.minor = F,
cutoffLineWidth = 0.5,
borderWidth = 0.5,
colCustom = key.vals.wt)
dev.off()
tiff("rlr_gskvdmso_volcano.tiff",units="in",width=6,height=6,res=600)
EnhancedVolcano(b.rlr.gskvdmso.volcano,
lab=rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table),
x="Log2FC",
y="pvalue",
selectLab =  selectlabs,
pCutoff = 0.05,
FCcutoff= 0,
ylim=c(1,5),
xlim=c(-2,2),
axisLabSize = 12,
title=NULL,
subtitle=NULL,
caption=NULL,
#transcriptPointSize = 0.5,
legendPosition = 0,
pointSize =
ifelse(rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table) %in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_DNA_METHYLATION ,
keytype = "ENTREZID", column="SYMBOL")),2.5,
ifelse(rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table)%in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),2.5,
ifelse(rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table)%in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c5$GO_lymphocyte_differentiation,
keytype = "ENTREZID", column="SYMBOL")),2.5,0.4))),
#ifelse(rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table)%in%
#         innateDB.viral.gene.names,2.5,0.4))),
labSize = 0,
colAlpha = 1,
gridlines.major = F,
gridlines.minor = F,
cutoffLineWidth = 0.5,
borderWidth = 0.5,
colCustom = key.vals.rlr)
dev.off()
selectlabs <- c(unname(mapIds(org.Mm.eg.db, keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),
unname(mapIds(org.Mm.eg.db, keys=Mm.c2$REACTOME_DNA_METHYLATION,
keytype = "ENTREZID", column="SYMBOL")),
unname(mapIds(org.Mm.eg.db, keys=Mm.hallmark$HALLMARK_MYC_TARGETS_V1,
keytype = "ENTREZID", column="SYMBOL")),
unname(mapIds(org.Mm.eg.db, keys=Mm.c5$GO_B_cell_differentiation,
keytype = "ENTREZID", column="SYMBOL")))
# edgeR: analyzing WT and RLR (triple mutant) B cells together
# Author: Seung June Kim
library(edgeR)
library(gplots)
library(RColorBrewer)
library(gplots)
library(devtools)
library(org.Mm.eg.db)
library(GO.db)
library(AnnotationDbi)
library(DBI)
library(VennDiagram)
library(EnhancedVolcano)
selectlabs <- c(unname(mapIds(org.Mm.eg.db, keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),
unname(mapIds(org.Mm.eg.db, keys=Mm.c2$REACTOME_DNA_METHYLATION,
keytype = "ENTREZID", column="SYMBOL")),
unname(mapIds(org.Mm.eg.db, keys=Mm.hallmark$HALLMARK_MYC_TARGETS_V1,
keytype = "ENTREZID", column="SYMBOL")),
unname(mapIds(org.Mm.eg.db, keys=Mm.c5$GO_B_cell_differentiation,
keytype = "ENTREZID", column="SYMBOL")))
key.vals.wt <- ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c2$REACTOME_DNA_METHYLATION,
keytype = "ENTREZID", column="SYMBOL")),'blue',
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),'red',
#ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
#       %in% innateDB.viral.gene.names,'darkorchid','snow4')))
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c5$GO_B_cell_differentiation,
keytype = "ENTREZID", column="SYMBOL")),'darkorchid','snow4')))
#key.vals.wt[is.na(key.vals.wt)] <- 'white'
names(key.vals.wt)[key.vals.wt=='snow4'] <- "Not Annotated"
names(key.vals.wt)[key.vals.wt=='blue'] <-"DNA methy"
#names(key.vals.wt)[key.vals.wt=='purple'] <- "Myc"
names(key.vals.wt)[key.vals.wt=='red'] <- "Nonsense"
names(key.vals.wt)[key.vals.wt=='darkorchid'] <- "innateDB"
tiff("wt_gskvdmso_volcano.tiff",units="in",width=6,height=6,res=600)
EnhancedVolcano(b.wt.gskvdmso.volcano,
lab=rownames(topTags(tr.wt.gskvdmso, n="Inf")$table),
x="Log2FC",
y="pvalue",
selectLab =  selectlabs,
pCutoff = 0.05,
FCcutoff= 0,
ylim=c(1,5),
xlim=c(-2,2),
axisLabSize = 12,
title=NULL,
subtitle=NULL,
caption=NULL,
#transcriptPointSize = 0.5,
legendPosition = 0,
pointSize =
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table) %in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_DNA_METHYLATION ,
keytype = "ENTREZID", column="SYMBOL")),2.5,
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)%in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),2.5,
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)%in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c5$GO_B_cell_differentiation,
keytype = "ENTREZID", column="SYMBOL")),2.5,0.4))),
#ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)%in%
#innateDB.viral.gene.names,2.5,0.4))),
labSize = 0,
colAlpha = 1,
gridlines.major = F,
gridlines.minor = F,
cutoffLineWidth = 0.5,
borderWidth = 0.5,
colCustom = key.vals.wt)
dev.off()
selectlabs <- c(unname(mapIds(org.Mm.eg.db, keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),
unname(mapIds(org.Mm.eg.db, keys=Mm.c2$REACTOME_DNA_METHYLATION,
keytype = "ENTREZID", column="SYMBOL")),
unname(mapIds(org.Mm.eg.db, keys=Mm.hallmark$HALLMARK_MYC_TARGETS_V1,
keytype = "ENTREZID", column="SYMBOL")),
unname(mapIds(org.Mm.eg.db, keys=Mm.c2$REACTOME_EUKARYOTIC_TRANSLATION_ELONGATION,
keytype = "ENTREZID", column="SYMBOL")))
key.vals.wt <- ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c2$REACTOME_DNA_METHYLATION,
keytype = "ENTREZID", column="SYMBOL")),'blue',
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),'red',
#ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
#       %in% innateDB.viral.gene.names,'darkorchid','snow4')))
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c2$REACTOME_EUKARYOTIC_TRANSLATION_ELONGATION,
keytype = "ENTREZID", column="SYMBOL")),'darkorchid','snow4')))
#key.vals.wt[is.na(key.vals.wt)] <- 'white'
names(key.vals.wt)[key.vals.wt=='snow4'] <- "Not Annotated"
names(key.vals.wt)[key.vals.wt=='blue'] <-"DNA methy"
#names(key.vals.wt)[key.vals.wt=='purple'] <- "Myc"
names(key.vals.wt)[key.vals.wt=='red'] <- "Nonsense"
names(key.vals.wt)[key.vals.wt=='darkorchid'] <- "innateDB"
tiff("wt_gskvdmso_volcano.tiff",units="in",width=6,height=6,res=600)
EnhancedVolcano(b.wt.gskvdmso.volcano,
lab=rownames(topTags(tr.wt.gskvdmso, n="Inf")$table),
x="Log2FC",
y="pvalue",
selectLab =  selectlabs,
pCutoff = 0.05,
FCcutoff= 0,
ylim=c(1,5),
xlim=c(-2,2),
axisLabSize = 12,
title=NULL,
subtitle=NULL,
caption=NULL,
#transcriptPointSize = 0.5,
legendPosition = 0,
pointSize =
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table) %in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_DNA_METHYLATION ,
keytype = "ENTREZID", column="SYMBOL")),2.5,
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)%in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),2.5,
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)%in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_EUKARYOTIC_TRANSLATION_ELONGATION,
keytype = "ENTREZID", column="SYMBOL")),2.5,0.4))),
#ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)%in%
#innateDB.viral.gene.names,2.5,0.4))),
labSize = 0,
colAlpha = 1,
gridlines.major = F,
gridlines.minor = F,
cutoffLineWidth = 0.5,
borderWidth = 0.5,
colCustom = key.vals.wt)
dev.off()
key.vals.wt <- ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c2$REACTOME_DNA_METHYLATION,
keytype = "ENTREZID", column="SYMBOL")),'blue',
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),'red',
#ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
#       %in% innateDB.viral.gene.names,'darkorchid','snow4')))
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c5$GO_B_cell_differentiation,
keytype = "ENTREZID", column="SYMBOL")),'darkorchid','snow4')))
key.vals.wt <- ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c2$REACTOME_DNA_METHYLATION,
keytype = "ENTREZID", column="SYMBOL")),'blue',
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),'red',
#ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
#       %in% innateDB.viral.gene.names,'darkorchid','snow4')))
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c5$GO_B_cell_activation,
keytype = "ENTREZID", column="SYMBOL")),'darkorchid','snow4')))
#key.vals.wt[is.na(key.vals.wt)] <- 'white'
names(key.vals.wt)[key.vals.wt=='snow4'] <- "Not Annotated"
names(key.vals.wt)[key.vals.wt=='blue'] <-"DNA methy"
#names(key.vals.wt)[key.vals.wt=='purple'] <- "Myc"
names(key.vals.wt)[key.vals.wt=='red'] <- "Nonsense"
names(key.vals.wt)[key.vals.wt=='darkorchid'] <- "innateDB"
tiff("wt_gskvdmso_volcano.tiff",units="in",width=6,height=6,res=600)
EnhancedVolcano(b.wt.gskvdmso.volcano,
lab=rownames(topTags(tr.wt.gskvdmso, n="Inf")$table),
x="Log2FC",
y="pvalue",
selectLab =  selectlabs,
pCutoff = 0.05,
FCcutoff= 0,
ylim=c(1,5),
xlim=c(-2,2),
axisLabSize = 12,
title=NULL,
subtitle=NULL,
caption=NULL,
#transcriptPointSize = 0.5,
legendPosition = 0,
pointSize =
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table) %in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_DNA_METHYLATION ,
keytype = "ENTREZID", column="SYMBOL")),2.5,
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)%in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),2.5,
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)%in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c5$GO_B_cell_activation,
keytype = "ENTREZID", column="SYMBOL")),2.5,0.4))),
#ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)%in%
#innateDB.viral.gene.names,2.5,0.4))),
labSize = 0,
colAlpha = 1,
gridlines.major = F,
gridlines.minor = F,
cutoffLineWidth = 0.5,
borderWidth = 0.5,
colCustom = key.vals.wt)
dev.off()
selectlabs <- c(unname(mapIds(org.Mm.eg.db, keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),
unname(mapIds(org.Mm.eg.db, keys=Mm.c2$REACTOME_DNA_METHYLATION,
keytype = "ENTREZID", column="SYMBOL")),
unname(mapIds(org.Mm.eg.db, keys=Mm.hallmark$HALLMARK_MYC_TARGETS_V1,
keytype = "ENTREZID", column="SYMBOL")),
# unname(mapIds(org.Mm.eg.db, keys=Mm.c5$GO_B_cell_activation,
#              keytype = "ENTREZID", column="SYMBOL")))
innateDB.viral.gene.names)
selectlabs <- c(unname(mapIds(org.Mm.eg.db, keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),
unname(mapIds(org.Mm.eg.db, keys=Mm.c2$REACTOME_DNA_METHYLATION,
keytype = "ENTREZID", column="SYMBOL")),
unname(mapIds(org.Mm.eg.db, keys=Mm.hallmark$HALLMARK_MYC_TARGETS_V1,
keytype = "ENTREZID", column="SYMBOL")),
# unname(mapIds(org.Mm.eg.db, keys=Mm.c5$GO_B_cell_activation,
#              keytype = "ENTREZID", column="SYMBOL")))
innateDB.viral.gene.names)
key.vals.wt <- ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c2$REACTOME_DNA_METHYLATION,
keytype = "ENTREZID", column="SYMBOL")),'blue',
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),'red',
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)
%in% innateDB.viral.gene.names,'darkorchid','snow4')))
#key.vals.wt[is.na(key.vals.wt)] <- 'white'
names(key.vals.wt)[key.vals.wt=='snow4'] <- "Not Annotated"
names(key.vals.wt)[key.vals.wt=='blue'] <-"DNA methy"
#names(key.vals.wt)[key.vals.wt=='purple'] <- "Myc"
names(key.vals.wt)[key.vals.wt=='red'] <- "Nonsense"
names(key.vals.wt)[key.vals.wt=='darkorchid'] <- "innateDB"
tiff("wt_gskvdmso_volcano.tiff",units="in",width=6,height=6,res=600)
EnhancedVolcano(b.wt.gskvdmso.volcano,
lab=rownames(topTags(tr.wt.gskvdmso, n="Inf")$table),
x="Log2FC",
y="pvalue",
selectLab =  selectlabs,
pCutoff = 0.05,
FCcutoff= 0,
ylim=c(1,5),
xlim=c(-2,2),
axisLabSize = 12,
title=NULL,
subtitle=NULL,
caption=NULL,
#transcriptPointSize = 0.5,
legendPosition = 0,
pointSize =
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table) %in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_DNA_METHYLATION ,
keytype = "ENTREZID", column="SYMBOL")),2.5,
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)%in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),2.5,
# ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)%in%
# unname(mapIds(org.Mm.eg.db,keys=Mm.c5$GO_B_cell_activation,
# keytype = "ENTREZID", column="SYMBOL")),2.5,0.4))),
ifelse(rownames(topTags(tr.wt.gskvdmso, n="Inf")$table)%in%
innateDB.viral.gene.names,2.5,0.4))),
labSize = 0,
colAlpha = 1,
gridlines.major = F,
gridlines.minor = F,
cutoffLineWidth = 0.5,
borderWidth = 0.5,
colCustom = key.vals.wt)
dev.off()
key.vals.rlr <- ifelse(rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c2$REACTOME_DNA_METHYLATION,
keytype = "ENTREZID", column="SYMBOL")),'blue',
ifelse(rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table)
%in% unname(mapIds(org.Mm.eg.db,
keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),'red',
ifelse(rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table)
%in% innateDB.viral.gene.names,'darkorchid','snow4')))
#key.vals.rlr[is.na(key.vals.rlr)] <- 'white'
names(key.vals.rlr)[key.vals.rlr=='snow4'] <- "Not Annotated"
names(key.vals.rlr)[key.vals.rlr=='blue'] <-"DNA methy"
#names(key.vals.rlr)[key.vals.rlr=='purple'] <- "Myc"
names(key.vals.rlr)[key.vals.rlr=='red'] <- "Nonsense"
names(key.vals.rlr)[key.vals.rlr=='darkorchid'] <- "innateDB"
tiff("rlr_gskvdmso_volcano.tiff",units="in",width=6,height=6,res=600)
EnhancedVolcano(b.rlr.gskvdmso.volcano,
lab=rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table),
x="Log2FC",
y="pvalue",
selectLab =  selectlabs,
pCutoff = 0.05,
FCcutoff= 0,
ylim=c(1,5),
xlim=c(-2,2),
axisLabSize = 12,
title=NULL,
subtitle=NULL,
caption=NULL,
#transcriptPointSize = 0.5,
legendPosition = 0,
pointSize =
ifelse(rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table) %in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_DNA_METHYLATION ,
keytype = "ENTREZID", column="SYMBOL")),2.5,
ifelse(rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table)%in%
unname(mapIds(org.Mm.eg.db,keys=Mm.c2$REACTOME_INFLUENZA_INFECTION,
keytype = "ENTREZID", column="SYMBOL")),2.5,
#  ifelse(rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table)%in%
# unname(mapIds(org.Mm.eg.db,keys=Mm.c5$GO_lymphocyte_differentiation,
# keytype = "ENTREZID", column="SYMBOL")),2.5,0.4))),
ifelse(rownames(topTags(tr.rlr.gskvdmso, n="Inf")$table)%in%
innateDB.viral.gene.names,2.5,0.4))),
labSize = 0,
colAlpha = 1,
gridlines.major = F,
gridlines.minor = F,
cutoffLineWidth = 0.5,
borderWidth = 0.5,
colCustom = key.vals.rlr)
dev.off()
R.home()
file.edit(file.path("~",".Rprofile"))
tiff(filename="up.combined_heatmap3_c2.tiff",units='in',width=7,height=6,res=600)
heatmap.3(cpm(b[,c(1:12)])[b.up.combined,],
col=colfunc2(12), scale="row", Rowv=NA, Colv=NA,
cexCol=0.7, labRow  = NA,
density.info = "none",trace="none", dendrogram = "none",
symkey=TRUE,symbreaks=TRUE,revC = FALSE,
lhei=c(1.2,5), lwid=c(4, 7),margins=c(5,10),cexRow=0.5,
rowsep=c(884,1087), RowSideColors=t(sideColVennD),
RowSideColorsSize = 6)
dev.off()
tiff(filename="up.combined_heatmap3_c2.tiff",units='in',width=7,height=6,res=600)
heatmap.3(cpm(b[,c(1:12)])[b.up.combined,],
col=colfunc2(12), scale="row", Rowv=NA, Colv=NA,
cexCol=0.7, labRow  = NA,
density.info = "none",trace="none", dendrogram = "none",
symkey=TRUE,symbreaks=TRUE,revC = FALSE,
lhei=c(1.2,5), lwid=c(4, 7),margins=c(5,10),cexRow=0.5,
rowsep=c(884,1087), RowSideColors=t(sideColVennD),
RowSideColorsSize = 2.5)
dev.off()
tiff(filename="up.combined_heatmap3_c2.tiff",units='in',width=7,height=6,res=600)
heatmap.3(cpm(b[,c(1:12)])[b.up.combined,],
col=colfunc2(12), scale="row", Rowv=NA, Colv=NA,
cexCol=0.7, labRow  = NA,
density.info = "none",trace="none", dendrogram = "none",
symkey=TRUE,symbreaks=TRUE,revC = FALSE,
lhei=c(1.2,5), lwid=c(4, 7),margins=c(5,10),cexRow=0.5,
rowsep=c(884,1087), RowSideColors=t(sideColVennD),
RowSideColorsSize = 2.5)
dev.off()
tiff(filename="dn.combined_heatmap3_c2.tiff",units='in',width=7,height=6,res=600)
heatmap.3(cpm(b[,c(1:12)])[b.dn.combined,],
col=colfunc2(12), scale="row", Rowv=NA, Colv=NA,
cexCol=0.7, labRow  = NA,
density.info = "none",trace="none", dendrogram = "none",
symkey=TRUE,symbreaks=TRUE,revC = FALSE,
lhei=c(1.2,5), lwid=c(4, 7),margins=c(5,10),cexRow=0.5,
rowsep=c(922,1088), RowSideColors=t(dn.sideColVennD),
RowSideColorsSize = 2.5)
dev.off()
cpm(b)
# edgeR: analyzing WT and RLR (triple mutant) B cells together
# Author: Seung June Kim
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.17")
library(BiocManager)
BiocManager::install(edgeR)
BiocManager::install('edgeR')
library(edgeR)
libraries <- c('edgeR',
'gplots',
'RcolorBrewer',
'org.Mm.eg.db',
'EnhancedVolcano')
BiocManager::install(libraries)
install.packages('bookdown')
library(bookdown)
